---
title: è§‚å¯Ÿè€…æ¨¡å¼
date: 2022-05-22 14:11:34
categories: è¡Œä¸ºå‹æ¨¡å¼
tags: è®¾è®¡æ¨¡å¼
cover: 	https://refactoring.guru/images/patterns/content/observer/observer.png
---

## ğŸ’­ ä»€ä¹ˆæ˜¯è§‚å¯Ÿè€…æ¨¡å¼?

> ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œ å…è®¸ä½ å®šä¹‰ä¸€ç§è®¢é˜…æœºåˆ¶ï¼Œ å¯åœ¨å¯¹è±¡äº‹ä»¶å‘ç”Ÿæ—¶é€šçŸ¥å¤šä¸ª â€œè§‚å¯Ÿâ€ è¯¥å¯¹è±¡çš„å…¶ä»–å¯¹è±¡ã€‚
> 

## ä¸ºä»€ä¹ˆä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼?

### â˜¹ï¸é—®é¢˜

å‡å¦‚æœ‰ä¸¤ç§ç±»å‹çš„å¯¹è±¡ï¼šçŸ­è§†é¢‘å¹³å°çš„ç”¨æˆ·å’ŒçŸ­è§†é¢‘å†…å®¹çš„åˆ›ä½œè€…ã€‚ç”¨æˆ·å¯¹æŸä¸ªå†…å®¹åˆ›ä½œè€…æ‹æ‘„æˆ–è€…å‰ªè¾‘çš„è§†é¢‘ååˆ†çš„æ„Ÿå…´è¶£ï¼Œä½†æ˜¯è¯¥ä½œè€…è§†é¢‘æ›´æ–°å¹¶æ²¡æœ‰è§„å¾‹ã€‚

è¿™ä¸ªæ—¶å€™ç”¨æˆ·å¯èƒ½éœ€è¦ç»å¸¸æ‰“å¼€è§†é¢‘è½¯ä»¶æ¥æŸ¥çœ‹è‡ªå·±æ„Ÿå…´è¶£çš„åšä¸»æœ‰æ²¡æœ‰æ›´æ–°è§†é¢‘ï¼Œå¯èƒ½å¤§å¤šæ—¶å€™æ˜¯å¾’åŠ³çš„æµè§ˆã€‚

å¦ä¸€ç§æƒ…å†µå°±æ˜¯è§†é¢‘å¹³å°ä¸€æ—¦æ›´æ–°è§†é¢‘å°±ç«‹åˆ»æ¨é€ç»™æ‰€æœ‰çš„ç”¨æˆ·ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µä¸‹å¯èƒ½å—åˆ°çš„å¤§å¤šæ•°æ¨é€æ¶ˆæ¯éƒ½æ˜¯ä¼šè¢«ç”¨æˆ·è§†ä¸ºåƒåœ¾æ¨é€ï¼Œå› ä¸ºå¾ˆå¤§ä¸€éƒ¨åˆ†éƒ½æ˜¯è‡ªå·±ä¸æ„Ÿå…´è¶£çš„å†…å®¹ã€‚

è¾£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè¦ä¹ˆç”¨æˆ·é€‰æ‹©è‡ªå·±æ¯æ¬¡æ‰“å¼€è½¯ä»¶æœç´¢è‡ªå·±å–œæ¬¢çš„åšä¸»æŸ¥çœ‹æ˜¯å¦æœ‰å†…å®¹æ›´æ–°ï¼›è¦ä¹ˆè®©å¹³å°å®æ—¶æ¨é€æ–°çš„è§†é¢‘æ›´æ–°å†…å®¹ä¾›ç”¨æˆ·ç­›é€‰ã€‚ä½†æ˜¯è¿™ä¸¤ç§æ–¹å¼æ˜æ˜¾éƒ½å¾ˆæ²¡æœ‰ç”¨æˆ·ä½“éªŒã€‚

### ğŸ˜ƒ è§£å†³æ–¹æ¡ˆ

æ—¢ç„¶ç”¨æˆ·åªå…³å¿ƒè‡ªå·±æ„Ÿå…´è¶£çš„å†…å®¹åˆ›ä½œè€…ï¼Œé‚£ä¹ˆå°±å¯ä»¥èšç„¦å…³æ³¨ç‚¹ã€‚ç”±ç”¨æˆ·è®¢é˜…ï¼ˆå…³æ³¨ï¼‰è‡ªå·±å–œæ¬¢çš„åšä¸»ï¼Œå½“è¯¥åšä¸»çš„å†…å®¹åœ¨ç¬¬ä¸€æ—¶é—´æ›´æ–°ä¸Šä¼ ä¹‹åï¼Œç”±å¹³å°æ¨é€ç»™è®¢é˜…çš„ç”¨æˆ·å³å¯ã€‚è¿™æ ·æ—¢å¯ä»¥é¿å…åƒåœ¾æ¨é€ï¼Œåˆèƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚

> æ‹¥æœ‰ä¸€äº›å€¼å¾—å…³æ³¨çš„çŠ¶æ€çš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸º*ç›®æ ‡*ï¼ˆçŸ­è§†é¢‘å†…å®¹çš„åˆ›ä½œè€…ï¼‰ï¼ŒÂ ç”±äºå®ƒè¦å°†è‡ªèº«çš„çŠ¶æ€æ”¹å˜é€šçŸ¥ç»™å…¶ä»–å¯¹è±¡ï¼ŒÂ æˆ‘ä»¬ä¹Ÿå°†å…¶ç§°ä¸º*å‘å¸ƒè€…*Â ï¼ˆpublisherï¼‰ã€‚Â æ‰€æœ‰å¸Œæœ›å…³æ³¨å‘å¸ƒè€…çŠ¶æ€å˜åŒ–çš„å…¶ä»–å¯¹è±¡è¢«ç§°ä¸º*è®¢é˜…è€…*Â ï¼ˆsubscribersï¼‰ï¼ˆçŸ­è§†é¢‘å¹³å°ç”¨æˆ·ï¼‰ã€‚
> 

è§‚å¯Ÿè€…æ¨¡å¼å»ºè®®ä½ ä¸ºå‘å¸ƒè€…ç±»æ·»åŠ è®¢é˜…æœºåˆ¶ï¼Œ è®©æ¯ä¸ªå¯¹è±¡éƒ½èƒ½è®¢é˜…æˆ–å–æ¶ˆè®¢é˜…å‘å¸ƒè€…äº‹ä»¶æµã€‚

1. ä¸€ä¸ªç”¨äºå­˜å‚¨è®¢é˜…è€…å¯¹è±¡å¼•ç”¨çš„åˆ—è¡¨æˆå‘˜å˜é‡ï¼›
2. å‡ ä¸ªç”¨äºæ·»åŠ æˆ–åˆ é™¤è¯¥åˆ—è¡¨ä¸­è®¢é˜…è€…çš„å…¬æœ‰æ–¹æ³•ã€‚

![Observer-parttern](https://picgo-xuexueli.oss-cn-beijing.aliyuncs.com/images/design-partter/Untitled.png)

## ğŸ› ï¸ æ€ä¹ˆä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼?

### è§‚å¯Ÿè€…æ¨¡å¼çš„ç»“æ„

![Observer-parttern](https://picgo-xuexueli.oss-cn-beijing.aliyuncs.com/images/design-partter/Untitled%201.png)

**å‘å¸ƒè€…**Â ï¼ˆPublisherï¼‰Â ä¼šå‘å…¶ä»–å¯¹è±¡å‘é€å€¼å¾—å…³æ³¨çš„äº‹ä»¶ã€‚Â äº‹ä»¶ä¼šåœ¨å‘å¸ƒè€…è‡ªèº«çŠ¶æ€æ”¹å˜æˆ–æ‰§è¡Œç‰¹å®šè¡Œä¸ºåå‘ç”Ÿã€‚Â å‘å¸ƒè€…ä¸­åŒ…å«ä¸€ä¸ªå…è®¸æ–°è®¢é˜…è€…åŠ å…¥å’Œå½“å‰è®¢é˜…è€…ç¦»å¼€åˆ—è¡¨çš„è®¢é˜…æ„æ¶ã€‚

> å½“æ–°äº‹ä»¶å‘ç”Ÿæ—¶ï¼ŒÂ å‘é€è€…ä¼šéå†è®¢é˜…åˆ—è¡¨å¹¶è°ƒç”¨æ¯ä¸ªè®¢é˜…è€…å¯¹è±¡çš„é€šçŸ¥æ–¹æ³•ã€‚Â è¯¥æ–¹æ³•æ˜¯åœ¨è®¢é˜…è€…æ¥å£ä¸­å£°æ˜çš„ã€‚
> 

**è®¢é˜…è€…**Â ï¼ˆSubscriberï¼‰ï¼šÂ æ¥å£å£°æ˜äº†é€šçŸ¥æ¥å£ã€‚Â 

> åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒÂ è¯¥æ¥å£ä»…åŒ…å«ä¸€ä¸ªÂ `update`æ›´æ–°æ–¹æ³•ã€‚Â è¯¥æ–¹æ³•å¯ä»¥æ‹¥æœ‰å¤šä¸ªå‚æ•°ï¼ŒÂ ä½¿å‘å¸ƒè€…èƒ½åœ¨æ›´æ–°æ—¶ä¼ é€’äº‹ä»¶çš„è¯¦ç»†ä¿¡æ¯ã€‚
> 

**å…·ä½“è®¢é˜…è€…**Â ï¼ˆConcrete Subscribersï¼‰Â å¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œæ¥å›åº”å‘å¸ƒè€…çš„é€šçŸ¥ã€‚Â æ‰€æœ‰å…·ä½“è®¢é˜…è€…ç±»éƒ½å®ç°äº†åŒæ ·çš„æ¥å£ï¼ŒÂ å› æ­¤å‘å¸ƒè€…ä¸éœ€è¦ä¸å…·ä½“ç±»ç›¸è€¦åˆã€‚

> è®¢é˜…è€…é€šå¸¸éœ€è¦ä¸€äº›ä¸Šä¸‹æ–‡ä¿¡æ¯æ¥æ­£ç¡®åœ°å¤„ç†æ›´æ–°ã€‚Â å› æ­¤ï¼ŒÂ å‘å¸ƒè€…é€šå¸¸ä¼šå°†ä¸€äº›ä¸Šä¸‹æ–‡æ•°æ®ä½œä¸ºé€šçŸ¥æ–¹æ³•çš„å‚æ•°è¿›è¡Œä¼ é€’ã€‚Â å‘å¸ƒè€…ä¹Ÿå¯å°†è‡ªèº«ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ï¼ŒÂ ä½¿è®¢é˜…è€…ç›´æ¥è·å–æ‰€éœ€çš„æ•°æ®ã€‚
> 

**å®¢æˆ·ç«¯**Â ï¼ˆClientï¼‰Â ä¼šåˆ†åˆ«åˆ›å»ºå‘å¸ƒè€…å’Œè®¢é˜…è€…å¯¹è±¡ï¼ŒÂ ç„¶åä¸ºè®¢é˜…è€…æ³¨å†Œå‘å¸ƒè€…æ›´æ–°ã€‚

### å®ç°æ–¹å¼

1. æ£€æŸ¥ä¸šåŠ¡é€»è¾‘ï¼Œè¯•ç€å°†é€»è¾‘æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š 1ï¸âƒ£ç‹¬ç«‹äºå…¶ä»–ä»£ç çš„æ ¸å¿ƒåŠŸèƒ½å°†ä½œä¸ºå‘å¸ƒè€…ï¼› 2ï¸âƒ£å…¶ä»–ä»£ç è½¬åŒ–ä¸ºè®¢é˜…è€…ã€‚
2. å£°æ˜è®¢é˜…è€…æ¥å£ã€‚Â è¯¥æ¥å£è‡³å°‘åº”å£°æ˜ä¸€ä¸ªÂ `update`æ–¹æ³•ã€‚
3. å£°æ˜å‘å¸ƒè€…æ¥å£å¹¶å®šä¹‰ä¸€äº›æ¥å£æ¥åœ¨åˆ—è¡¨ä¸­æ·»åŠ å’Œåˆ é™¤è®¢é˜…å¯¹è±¡ã€‚Â 
   
    > å‘å¸ƒè€…å¿…é¡»ä»…é€šè¿‡è®¢é˜…è€…æ¥å£ä¸å®ƒä»¬è¿›è¡Œäº¤äº’ã€‚
    > 
4. ç¡®å®šå­˜æ”¾å®é™…è®¢é˜…åˆ—è¡¨çš„ä½ç½®å¹¶å®ç°è®¢é˜…æ–¹æ³•ã€‚
   
    > é€šå¸¸æ‰€æœ‰ç±»å‹çš„å‘å¸ƒè€…ä»£ç çœ‹ä¸Šå»éƒ½ä¸€æ ·ï¼Œ å› æ­¤å°†åˆ—è¡¨æ”¾ç½®åœ¨ç›´æ¥æ‰©å±•è‡ªå‘å¸ƒè€…æ¥å£çš„æŠ½è±¡ç±»ä¸­æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ å…·ä½“å‘å¸ƒè€…ä¼šæ‰©å±•è¯¥ç±»ä»è€Œç»§æ‰¿æ‰€æœ‰çš„è®¢é˜…è¡Œä¸ºã€‚
    > 
5. åˆ›å»ºå…·ä½“å‘å¸ƒè€…ç±»ã€‚
   
    > æ¯æ¬¡å‘å¸ƒè€…å‘ç”Ÿäº†é‡è¦äº‹ä»¶æ—¶éƒ½å¿…é¡»é€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…ã€‚
    > 
6. åœ¨å…·ä½“è®¢é˜…è€…ç±»ä¸­å®ç°é€šçŸ¥æ›´æ–°çš„æ–¹æ³•ã€‚
   
    > 1ï¼‰ ç»å¤§éƒ¨åˆ†è®¢é˜…è€…éœ€è¦ä¸€äº›ä¸äº‹ä»¶ç›¸å…³çš„ä¸Šä¸‹æ–‡æ•°æ®ã€‚ è¿™äº›æ•°æ®å¯ä½œä¸ºé€šçŸ¥æ–¹æ³•çš„å‚æ•°æ¥ä¼ é€’ã€‚
    2ï¼‰ä½†è¿˜æœ‰å¦ä¸€ç§é€‰æ‹©ã€‚ è®¢é˜…è€…æ¥æ”¶åˆ°é€šçŸ¥åç›´æ¥ä»é€šçŸ¥ä¸­è·å–æ‰€æœ‰æ•°æ®ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å‘å¸ƒè€…å¿…é¡»é€šè¿‡æ›´æ–°æ–¹æ³•å°†è‡ªèº«ä¼ é€’å‡ºå»ã€‚
    3ï¼‰ å¦ä¸€ç§ä¸å¤ªçµæ´»çš„æ–¹å¼æ˜¯é€šè¿‡æ„é€ å‡½æ•°å°†å‘å¸ƒè€…ä¸è®¢é˜…è€…æ°¸ä¹…æ€§åœ°è¿æ¥èµ·æ¥ã€‚
    > 
7. å®¢æˆ·ç«¯å¿…é¡»ç”Ÿæˆæ‰€éœ€çš„å…¨éƒ¨è®¢é˜…è€…ï¼ŒÂ å¹¶åœ¨ç›¸åº”çš„å‘å¸ƒè€…å¤„å®Œæˆæ³¨å†Œå·¥ä½œã€‚

## ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼?

- ğŸ  å½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€çš„æ”¹å˜éœ€è¦æ”¹å˜å…¶ä»–å¯¹è±¡ï¼ŒÂ æˆ–å®é™…å¯¹è±¡æ˜¯äº‹å…ˆæœªçŸ¥çš„æˆ–åŠ¨æ€å˜åŒ–çš„æ—¶ï¼ŒÂ å¯ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚
  
    > å½“ä½ ä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢ç±»æ—¶é€šå¸¸ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ã€‚ æ¯”å¦‚ï¼Œ ä½ åˆ›å»ºäº†è‡ªå®šä¹‰æŒ‰é’®ç±»å¹¶å…è®¸å®¢æˆ·ç«¯åœ¨æŒ‰é’®ä¸­æ³¨å…¥è‡ªå®šä¹‰ä»£ç ï¼Œ è¿™æ ·å½“ç”¨æˆ·æŒ‰ä¸‹æŒ‰é’®æ—¶å°±ä¼šè§¦å‘è¿™äº›ä»£ç ã€‚
    > 
    > 
    > è§‚å¯Ÿè€…æ¨¡å¼å…è®¸ä»»ä½•å®ç°äº†è®¢é˜…è€…æ¥å£çš„å¯¹è±¡è®¢é˜…å‘å¸ƒè€…å¯¹è±¡çš„äº‹ä»¶é€šçŸ¥ã€‚ ä½ å¯åœ¨æŒ‰é’®ä¸­æ·»åŠ è®¢é˜…æœºåˆ¶ï¼Œ å…è®¸å®¢æˆ·ç«¯é€šè¿‡è‡ªå®šä¹‰è®¢é˜…ç±»æ³¨å…¥è‡ªå®šä¹‰ä»£ç ã€‚
    > 
- ğŸ  å½“åº”ç”¨ä¸­çš„ä¸€äº›å¯¹è±¡å¿…é¡»è§‚å¯Ÿå…¶ä»–å¯¹è±¡æ—¶ï¼ŒÂ å¯ä½¿ç”¨è¯¥æ¨¡å¼ã€‚Â ä½†ä»…èƒ½åœ¨æœ‰é™æ—¶é—´å†…æˆ–ç‰¹å®šæƒ…å†µä¸‹ä½¿ç”¨ã€‚
  
    > è®¢é˜…åˆ—è¡¨æ˜¯åŠ¨æ€çš„ï¼Œ å› æ­¤è®¢é˜…è€…å¯éšæ—¶åŠ å…¥æˆ–ç¦»å¼€è¯¥åˆ—è¡¨ã€‚
    > 
    
    æ ¸å¿ƒ Java ç¨‹åºåº“ä¸­è¯¥æ¨¡å¼çš„ä¸€äº›ç¤ºä¾‹ï¼š
    
- [java.util.Observer](http://docs.oracle.com/javase/8/docs/api/java/util/Observer.html) /Â [java.util.Observable](http://docs.oracle.com/javase/8/docs/api/java/util/Observable.html)ï¼ˆæå°‘åœ¨çœŸå®ä¸–ç•Œä¸­ä½¿ç”¨ï¼‰
- [java.util.EventListener](http://docs.oracle.com/javase/8/docs/api/java/util/EventListener.html)çš„æ‰€æœ‰å®ç°Â ï¼ˆå‡ ä¹å¹¿æ³›å­˜åœ¨äº Swing ç»„ä»¶ä¸­ï¼‰
- [javax.servlet.http.HttpSessionBindingListener](http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSessionBindingListener.html)
- [javax.servlet.http.HttpSessionAttributeListener](http://docs.oracle.com/javaee/7/api/javax/servlet/http/HttpSessionAttributeListener.html)
- [javax.faces.event.PhaseListener](http://docs.oracle.com/javaee/7/api/javax/faces/event/PhaseListener.html)